import{d as se,r as c,k as y,o as ue,w as re,f as D,g as x,h as u,A as a,z as i,C as m,m as b,bE as U,bB as N,bC as X,a as _,B as S,cu as ie,bF as q,_ as de}from"./index-Dks_UUQM.js";import{D as fe}from"./dutils-CTazb8Sy.js";import{_ as B}from"./KTextWithBg.vue_vue_type_script_setup_true_lang-CCnIrzBK.js";import ve from"./DrawingTool-Cba_syAv.js";import{f as ce}from"./myUtils-CO6ajrRf.js";import{a as xe}from"./functional-gsVEwKX3.js";import{s as me}from"./index-BxBGDVG2.js";const pe={class:"flex flex-col md:flex-row gap-6 p-4 bg-gray-50 shadow mkonva"},ge={class:"flex-1"},ye={class:"border rounded-lg overflow-hidden bg-white"},_e={class:"p-2 flex justify-between items-center border-left-blue"},be={class:"flex gap-2"},we={class:"relative"},he={class:"w-full md:w-120 space-y-2"},ke={class:"bg-white p-4 rounded-lg shadow border-left-blue"},Ve={class:"bg-white p-4 rounded-lg shadow border-left-blue"},Ce={class:"text-lg font-mono"},Se={class:"text-lg font-mono"},Fe={class:"bg-white p-4 rounded-lg shadow"},Le={class:"space-y-2"},t=40,$e="$$(y-b) \\over x $$",ze=se({name:"JLinear",__name:"jlinear",setup(De){let F=940,K=580,l={x:F/2,y:K/2};const R=c({lines:[],labels:[]}),d=c(1),I=c(!0),s=c(0),w=c("x"),L=c(!0),h=c(!0),G=c(!0),$=c(!0),T=c(!1),M=c({x:0,y:0}),A=c(null),W=c(null),J=y(()=>{let o="";const{value:e}=d,{value:r}=s;if(e===0)return`${r}`;if(Math.abs(e)===1?o+=e>0?"x":"-x":o+=`${e}x`,r!==0){const f=r>0?" + ":" - ";o+=`${f}${Math.abs(r)}`}return o}),p=y(()=>d.value===0?null:-s.value/d.value),O=y(()=>s.value),Y=y(()=>{if(!I.value||!h.value)return null;const o=p.value,e=d.value*o+s.value,r=l.x+o*t,f=l.y-e*t,v=t*5,k=d.value*t*5;return{points:[r,f,r+v,f,r+v,f-k],stroke:"#ff6b6b",strokeWidth:2,fill:"rgba(255, 107, 107, 0.3)",closed:!0}}),E=y(()=>{if(!h.value)return null;const o=d.value*(-l.x/t)+s.value,e=d.value*(l.x/t)+s.value,r=(l.y/t-s.value)/d.value,f=(-l.y/t-s.value)/d.value,v=[];return o>=-l.y/t&&o<=l.y/t&&v.push({x:-l.x/t,y:o}),e>=-l.y/t&&e<=l.y/t&&v.push({x:l.x/t,y:e}),r>=-l.x/t&&r<=l.x/t&&v.push({x:r,y:l.y/t}),f>=-l.x/t&&f<=l.x/t&&v.push({x:f,y:-l.y/t}),{points:v.length>=2?[l.x+v[0].x*t,l.y-v[0].y*t,l.x+v[1].x*t,l.y-v[1].y*t]:[l.x-l.x,l.y-o*t,l.x+l.x,l.y-e*t],stroke:"#3a7bd5",strokeWidth:3}}),Q=y(()=>!L.value||!h.value?null:{x:l.x+10,y:l.y-s.value*t-10,text:`y截距: ${s.value.toFixed(2)}`,fontSize:16,fill:"#4ecdc4"}),Z=y(()=>!$.value||!h.value||p.value===null?null:{x:l.x+p.value*t,y:l.y+20,text:`x截距: ${p.value.toFixed(2)}`,fontSize:16,fill:"#ffa502"}),ee=y(()=>{if(!h.value)return[];const o=[];return L.value&&o.push({x:l.x,y:l.y-s.value*t,radius:6,fill:"#4ecdc4",stroke:"#fff",strokeWidth:2}),$.value&&p.value!==null&&o.push({x:l.x+p.value*t,y:l.y,radius:6,fill:"#ffa502",stroke:"#fff",strokeWidth:2}),o}),le=()=>{d.value=1,s.value=0},P=()=>{let o=ce(w.value);o!=w.value&&(w.value=o);let e=xe(o);d.value=e.k,s.value=e.b},te=()=>{d.value=1,s.value=0};return ue(()=>{var e;R.value=fe.drawGrid(F,K,l,t);const o=(e=A.value)==null?void 0:e.getStage();o&&o.on("mousemove",r=>{const f=o.getPointerPosition();f&&(M.value={x:Math.round(f.x),y:Math.round(f.y)})})}),re([d,s],()=>{w.value=J.value}),(o,e)=>{const r=m("v-line"),f=m("v-text"),v=m("v-circle"),k=m("v-layer"),oe=m("v-stage"),j=m("el-slider"),g=m("el-form-item"),ae=m("el-button"),H=m("el-form"),ne=m("el-input"),z=m("el-checkbox");return x(),D("div",pe,[u("div",ge,[u("div",ye,[u("div",null,[u("div",_e,[e[8]||(e[8]=u("div",{class:"text-sm font-medium text-gray-700 bg-gray"}," 探索一次函数 y = kx + b 的图像变化规律 ",-1)),u("div",be,[a(ve,{enableDrawing:T.value,"onUpdate:enableDrawing":e[0]||(e[0]=n=>T.value=n),stageRef:A.value,drawingLayerRef:W.value},null,8,["enableDrawing","stageRef","drawingLayerRef"])])]),u("div",we,[a(oe,{ref_key:"stageRef",ref:A,config:{width:_(F),height:_(K)}},{default:i(()=>[a(k,null,{default:i(()=>{var n;return[(x(!0),D(N,null,X(R.value.lines,(V,C)=>(x(),b(r,{key:"grid-"+C,config:V},null,8,["config"]))),128)),(x(!0),D(N,null,X(R.value.labels,(V,C)=>(x(),b(f,{key:"axe-label-"+C,config:V},null,8,["config"]))),128)),E.value?(x(),b(r,{key:0,config:E.value},null,8,["config"])):U("",!0),Y.value?(x(),b(r,{key:1,config:Y.value},null,8,["config"])):U("",!0),a(B,{text:"斜率: "+((n=d.value)==null?void 0:n.toFixed(2)),x:_(F)-200,y:2,fontSize:16,"bg-color":"#ef4444bb","text-color":"white","corner-radius":8},null,8,["text","x"]),Z.value?(x(),b(B,{key:2,text:"x截距: "+p.value.toFixed(2),x:_(l).x+p.value*t,y:_(l).y+20,fontSize:16,"bg-color":"#ef4444aa","text-color":"white","corner-radius":8},null,8,["text","x","y"])):U("",!0),Q.value?(x(),b(B,{key:3,text:"y截距: "+s.value.toFixed(2),x:_(l).x+10,y:_(l).y-s.value*t-10,fontSize:16,"bg-color":"#10b981aa","text-color":"white","corner-radius":8},null,8,["text","x","y"])):U("",!0),(x(!0),D(N,null,X(ee.value,(V,C)=>(x(),b(v,{key:"point-"+C,config:V},null,8,["config"]))),128)),a(B,{text:"坐标: ( "+M.value.x+", "+M.value.y+" )",x:2,y:10,fontSize:16,"bg-color":"#333333bb","text-color":"white","corner-radius":8},null,8,["text"])]}),_:1}),a(k,{ref_key:"drawingLayerRef",ref:W},null,512)]),_:1},8,["config"])])])])]),u("div",he,[u("div",ke,[e[10]||(e[10]=u("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"参数控制",-1)),a(H,null,{default:i(()=>[a(g,{label:"斜率k",class:""},{default:i(()=>[a(j,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=n=>d.value=n),min:-5,max:5,step:.1,"show-input":""},null,8,["modelValue"])]),_:1}),a(g,{label:"截距b",class:""},{default:i(()=>[a(j,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=n=>s.value=n),min:-10,max:10,step:.1,"show-input":!0},null,8,["modelValue"])]),_:1}),a(g,{label:"",class:""},{default:i(()=>[a(ae,{type:"info",class:"w-full",onClick:le},{default:i(()=>e[9]||(e[9]=[S(" 重置 ")])),_:1,__:[9]})]),_:1})]),_:1})]),u("div",Ve,[e[12]||(e[12]=u("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"方程信息:",-1)),a(H,{class:"right-forms","label-position":"right","label-width":"100"},{default:i(()=>[a(g,{label:"y = ",class:"",style:{"margin-bottom":"10px !important"}},{default:i(()=>[a(ne,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=n=>w.value=n),style:{"font-size":"21px"},onBlur:P,onClear:te,onKeyup:ie(P,["enter"])},null,8,["modelValue"])]),_:1}),a(g,{label:"斜率K = ",class:""},{default:i(()=>[a(_(me),{formula:$e})]),_:1}),a(g,{label:"Y轴交点 = ",class:""},{default:i(()=>{var n;return[u("p",Ce,q((n=O.value)==null?void 0:n.toFixed(2)),1)]}),_:1}),a(g,{label:"X轴交点 = ",class:""},{default:i(()=>{var n;return[u("p",Se,q((n=p.value)==null?void 0:n.toFixed(2)),1)]}),_:1}),a(g,{label:"斜率K关系:",class:""},{default:i(()=>e[11]||(e[11]=[u("p",{class:"text-lg font-mono"},"两条互垂线斜率：K1*K2=-1",-1)])),_:1,__:[11]})]),_:1})]),u("div",Fe,[e[17]||(e[17]=u("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"显示选项",-1)),u("div",Le,[a(z,{modelValue:G.value,"onUpdate:modelValue":e[4]||(e[4]=n=>G.value=n)},{default:i(()=>e[13]||(e[13]=[S("显示网格")])),_:1,__:[13]},8,["modelValue"]),a(z,{modelValue:I.value,"onUpdate:modelValue":e[5]||(e[5]=n=>I.value=n)},{default:i(()=>e[14]||(e[14]=[S("显示斜率")])),_:1,__:[14]},8,["modelValue"]),a(z,{modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=n=>L.value=n)},{default:i(()=>e[15]||(e[15]=[S("显示y截距")])),_:1,__:[15]},8,["modelValue"]),a(z,{modelValue:$.value,"onUpdate:modelValue":e[7]||(e[7]=n=>$.value=n),disabled:p.value===null},{default:i(()=>e[16]||(e[16]=[S(" 显示x截距 ")])),_:1,__:[16]},8,["modelValue","disabled"])])])])])}}}),Ne=de(ze,[["__scopeId","data-v-19487a22"]]);export{Ne as default};
