var ae=Object.defineProperty;var G=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var K=(e,r,t)=>r in e?ae(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,O=(e,r)=>{for(var t in r||(r={}))ue.call(r,t)&&K(e,t,r[t]);if(G)for(var t of G(r))re.call(r,t)&&K(e,t,r[t]);return e};var L=(e,r,t)=>new Promise((V,d)=>{var b=c=>{try{i(t.next(c))}catch(f){d(f)}},m=c=>{try{i(t.throw(c))}catch(f){d(f)}},i=c=>c.done?V(c.value):Promise.resolve(c.value).then(b,m);i((t=t.apply(e,r)).next())});import{S as ce}from"./sortable.esm-VSgMS8pS.js";import{d as ie,r as s,dv as S,c8 as v,k as $,A as l,p as oe,c as k,bB as M,e as p,C as u,B,a as P,bS as D,c3 as se,bQ as de,c6 as fe,n as ve,j as me,cL as xe,bG as be}from"./index-BxizvH50.js";import{u as he}from"./epTheme-CflWbo4Q.js";import{E as Ce,R as ge,C as ye,D as ke,S as pe}from"./collapse-B1DpZU48.js";function we(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!xe(e)}const Ee={title:{type:String,default:"列表"},vxeTableRef:{type:Object},columns:{type:Array,default:()=>[]},tree:{type:Boolean,default:!1},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},Te=ie({name:"VxeTableBar",props:Ee,emits:["refresh","fullscreen"],setup(e,{emit:r,slots:t,attrs:V}){const d=s("small"),b=s(!1),m=s(!0),i=s(!1),c=s(!1),f=me(),h=s(e.isExpandAll);let x=S(v(e==null?void 0:e.columns),"title");const C=s(S(v(e==null?void 0:e.columns),"title")),o=s(v(e==null?void 0:e.columns)),A=$(()=>n=>({background:n===d.value?he().epThemeColor:"",color:n===d.value?"#fff":"var(--el-text-color-primary)"})),g=$(()=>["text-black","dark:text-white","duration-100","hover:text-primary!","cursor-pointer","outline-hidden"]),H=$(()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]);function Q(){b.value=!0,r("refresh"),fe(500).then(()=>b.value=!1)}function U(){h.value=!h.value,h.value?e.vxeTableRef.setAllTreeExpand(!0):e.vxeTableRef.clearTreeExpand(),e.vxeTableRef.refreshColumn()}function q(){i.value=!i.value,r("fullscreen",i.value)}function j(){const n=v(o.value).filter(a=>C.value.includes(a.title));e.vxeTableRef.reloadColumn(n)}function J(n){C.value=n?x:[],c.value=!1,j()}function W(n){C.value=n;const a=n.length;m.value=a===x.length,c.value=a>0&&a<x.length}function X(){return L(this,null,function*(){m.value=!0,c.value=!1,o.value=v(e==null?void 0:e.columns),x=[],x=yield S(v(e==null?void 0:e.columns),"title"),C.value=S(v(e==null?void 0:e.columns),"title"),e.vxeTableRef.refreshColumn()})}function F(n){d.value=n,e.vxeTableRef.refreshColumn()}const Y={dropdown:()=>l(u("el-dropdown-menu"),{class:"translation"},{default:()=>[l(u("el-dropdown-item"),{style:A.value("medium"),onClick:()=>F("medium")},{default:()=>[B("宽松")]}),l(u("el-dropdown-item"),{style:A.value("small"),onClick:()=>F("small")},{default:()=>[B("默认")]}),l(u("el-dropdown-item"),{style:A.value("mini"),onClick:()=>F("mini")},{default:()=>[B("紧凑")]})]})},Z=n=>{n.preventDefault(),ve(()=>{var E;const a=((E=f==null?void 0:f.proxy)==null?void 0:E.$refs[`VxeGroupRef${P(e.tableKey)}`]).$el.firstElementChild;ce.create(a,{animation:300,handle:".drag-btn",onEnd:({newIndex:y,oldIndex:T,item:te})=>{const _=te,z=_.parentNode,I=o.value[T],N=o.value[y];if(I!=null&&I.fixed||N!=null&&N.fixed){const R=z.children[T];y>T?z.insertBefore(_,R):z.insertBefore(_,R&&R.nextElementSibling);return}const ne=o.value.splice(T,1)[0];o.value.splice(y,0,ne),j()}})})},ee=n=>!!o.value.filter(a=>D(a.title)===D(n))[0].fixed,w=n=>({content:n,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),le={reference:()=>k(l(pe,{class:["w-[16px]",g.value]},null),[[p("tippy"),w("列设置")]])};return()=>{let n;return l(M,null,[l("div",oe(V,{class:["w-full","px-2","pb-2","bg-bg_color",i.value?["h-full!","z-2002","fixed","inset-0"]:"mt-2"]}),[l("div",{class:"flex justify-between w-full h-[60px] p-4"},[t!=null&&t.title?t.title():l("p",{class:"font-bold truncate"},[e.title]),l("div",{class:"flex items-center justify-around"},[t!=null&&t.buttons?l("div",{class:"flex mr-4"},[t.buttons()]):null,e.tree?l(M,null,[k(l(Ce,{class:["w-[16px]",g.value],style:{transform:h.value?"none":"rotate(-90deg)"},onClick:()=>U()},null),[[p("tippy"),w(h.value?"折叠":"展开")]]),l(u("el-divider"),{direction:"vertical"},null)]):null,k(l(ge,{class:["w-[16px]",g.value,b.value?"animate-spin":""],onClick:()=>Q()},null),[[p("tippy"),w("刷新")]]),l(u("el-divider"),{direction:"vertical"},null),k(l(u("el-dropdown"),{trigger:"click"},O({default:()=>[l(ye,{class:["w-[16px]",g.value]},null)]},Y)),[[p("tippy"),w("密度")]]),l(u("el-divider"),{direction:"vertical"},null),l(u("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},O({default:()=>[l("div",{class:[H.value]},[l(u("el-checkbox"),{class:"-mr-1!",label:"列展示",modelValue:m.value,"onUpdate:modelValue":a=>m.value=a,indeterminate:c.value,onChange:a=>J(a)},null),l(u("el-button"),{type:"primary",link:!0,onClick:()=>X()},{default:()=>[B("重置")]})]),l("div",{class:"pt-[6px] pl-[11px]"},[l(u("el-scrollbar"),{"max-height":"36vh"},{default:()=>[l(u("el-checkbox-group"),{ref:`VxeGroupRef${P(e.tableKey)}`,modelValue:C.value,onChange:a=>W(a)},{default:()=>[l(u("el-space"),{direction:"vertical",alignment:"flex-start",size:0},we(n=x.map((a,E)=>l("div",{class:"flex items-center"},[l(ke,{class:["drag-btn w-[16px] mr-2",ee(a)?"cursor-no-drop!":"cursor-grab!"],onMouseenter:y=>Z(y)},null),l(u("el-checkbox"),{key:E,label:a,value:a,onChange:j},{default:()=>[l("span",{title:D(a),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[D(a)])]})])))?n:{default:()=>[n]})]})]})])]},le)),l(u("el-divider"),{direction:"vertical"},null),k(l(u("iconifyIconOffline"),{class:["w-[16px]",g.value],icon:i.value?se:de,onClick:()=>q()},null),[[p("tippy"),i.value?"退出全屏":"全屏"]])])]),t.default({size:d.value,dynamicColumns:o.value})])])}}}),Ae=be(Te);export{Ae as V};
