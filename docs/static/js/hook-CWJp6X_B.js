var k=(l,f,s)=>new Promise((u,m)=>{var p=a=>{try{c(s.next(a))}catch(i){m(i)}},r=a=>{try{c(s.throw(a))}catch(i){m(i)}},c=a=>a.done?u(a.value):Promise.resolve(a.value).then(p,r);c((s=s.apply(l,f)).next())});import{y as $,r as o,o as F,A as O,c_ as j,c4 as C,gK as x,cu as R,dB as z,cc as A,c8 as B,C as K,cl as N}from"./index-CaGTsnvz.js";import{_ as P}from"./form.vue_vue_type_script_setup_true_lang-DMgO0edy.js";import{e as V}from"./system-DyhNUda5.js";import{u as q}from"./hooks-BV6riCnP.js";import"./index-CB9i_X_C.js";function E(){const l=$({name:"",status:null}),f=o(),s=o([]),u=o(!0),{tagStyle:m}=q(),p=[{label:"部门名称",prop:"name",width:180,align:"left"},{label:"排序",prop:"sort",minWidth:70},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:t,props:e})=>O(K("el-tag"),{size:e.size,style:m.value(t.status)},{default:()=>[t.status===1?"启用":"停用"]})},{label:"创建时间",minWidth:200,prop:"createTime",formatter:({createTime:t})=>j(t).format("YYYY-MM-DD HH:mm:ss")},{label:"备注",prop:"remark",minWidth:320},{label:"操作",fixed:"right",width:210,slot:"operation"}];function r(t){}function c(t){t&&(t.resetFields(),a())}function a(){return k(this,null,function*(){u.value=!0;const{data:t}=yield V();let e=t;C(l.name)||(e=e.filter(n=>n.name.includes(l.name))),C(l.status)||(e=e.filter(n=>n.status===l.status)),s.value=x(e),setTimeout(()=>{u.value=!1},500)})}function i(t){if(!t||!t.length)return;const e=[];for(let n=0;n<t.length;n++)t[n].disabled=t[n].status===0,i(t[n].children),e.push(t[n]);return e}function H(t="新增",e){var n,d,h,g,D,b,v,y;z({title:`${t}部门`,props:{formInline:{higherDeptOptions:i(B(s.value)),parentId:(n=e==null?void 0:e.parentId)!=null?n:0,name:(d=e==null?void 0:e.name)!=null?d:"",principal:(h=e==null?void 0:e.principal)!=null?h:"",phone:(g=e==null?void 0:e.phone)!=null?g:"",email:(D=e==null?void 0:e.email)!=null?D:"",sort:(b=e==null?void 0:e.sort)!=null?b:0,status:(v=e==null?void 0:e.status)!=null?v:1,remark:(y=e==null?void 0:e.remark)!=null?y:""}},width:"40%",draggable:!0,fullscreen:A(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>N(P,{ref:f,formInline:null}),beforeSure:(S,{options:T})=>{const W=f.value.getRef(),Y=T.props.formInline;function I(){R(`您${t}了部门名称为${Y.name}的这条数据`,{type:"success"}),S(),a()}W.validate(_=>{_&&I()})}})}function M(t){R(`您删除了部门名称为${t.name}的这条数据`,{type:"success"}),a()}return F(()=>{a()}),{form:l,loading:u,columns:p,dataList:s,onSearch:a,resetForm:c,openDialog:H,handleDelete:M,handleSelectionChange:r}}export{E as useDept};
