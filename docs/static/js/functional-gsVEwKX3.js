const w=i=>{if(typeof i!="string")throw new Error("输入必须是字符串");const F=i.replace(/\s/g,"");let b=0,h=0,u=0;const l=e=>{if(!e||e==="+"||e==="-")return e==="-"?-1:1;if(e.startsWith("(")&&e.endsWith(")")&&(e=e.slice(1,-1)),e.includes("/")){const[o,n]=e.split("/"),g=parseFloat(o),p=parseFloat(n);return p===0?NaN:g/p}const c=parseFloat(e);return isNaN(c)?1:c},a=/([+-])?(\([^)]+\)|[^x]*)?(x²?|x)/g;let r;const f=[];for(;(r=a.exec(F))!==null;)r[0]&&f.push({sign:r[1]||"+",coefficient:r[2]||"",variable:r[3]}),r.index===a.lastIndex&&a.lastIndex++;const d=F.match(/([+-]?(?:\d*\.?\d*\/?\d*\.?\d*|\(\d*\.?\d*\/\d*\.?\d*\)))$/);d&&d[0]&&!d[0].includes("x")&&(u=l(d[0])),f.forEach(e=>{const c=e.sign==="-"?-1:1,o=l(e.coefficient)*c;isNaN(o)||(e.variable==="x²"?b+=o:e.variable==="x"&&(h+=o))});const t=e=>Math.abs(e)<1e-4?0:Math.round(e*1e4)/1e4,x=t(b),m=t(h),N=t(u),M=((e,c,o)=>{const n=[],g=s=>Math.abs(s)<1e-4?"0":Number.isInteger(s)?s.toString():s.toFixed(3).replace(/\.?0+$/,""),p=g(e),$=g(c),T=g(o);if(e!==0&&(p==="1"?n.push("x²"):p==="-1"?n.push("-x²"):n.push(`${p}x²`)),c!==0){let s="";c>0&&n.length>0&&(s="+"),$==="1"?n.push(`${s}x`):$==="-1"?n.push("-x"):n.push(`${s}${$}x`)}if(o!==0){let s="";o>0&&n.length>0&&(s="+"),n.push(`${s}${T}`)}return n.length>0?n.join(""):"0"})(x,m,N);return{isQuadratic:x!==0,a:x,b:m,c:N,f:M,functionString:`f(x) = ${M}`}},C=i=>{i=i.replace(/\s/g,"");const F=i,b=t=>t===""||t==="+"?1:t==="-"?-1:h(t),h=t=>{if(t=t.replace(/[()]/g,""),t.includes("/")){const[x,m]=t.split("/");return parseFloat(x)/parseFloat(m)}else return parseFloat(t)};if(i==="")return{k:0,b:0};const u=i.indexOf("x");let l="",a="";u!==-1?(l=i.substring(0,u+1),a=i.substring(u+1)):a=i;let r=0,f=0;if(l){const t=l.substring(0,l.length-1);r=b(t)}a&&(f=h(a));const d=t=>Math.abs(t)<1e-4?0:Math.round(t*1e4)/1e4;return r=d(r),f=d(f),{k:r,b:f,f:F}};export{C as a,w as p};
